<!-- http://127.0.0.1:8000/modified_euler -->


<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Modified Euler's Method - SolveMate</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
      background: #f2f2f2;
    }
    h1 {
      text-align: center;
      color: #222;
    }
    label, input {
      display: block;
      margin-top: 10px;
    }
    input {
      padding: 6px;
      width: 250px;
    }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      background: #0077cc;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    table {
      margin-top: 25px;
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
    }
    th {
      background-color: #0077cc;
      color: white;
    }
    .error {
      color: red;
      margin-top: 10px;
    }
    #result {
      margin-top: 20px;
      font-weight: bold;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
  <h1>Modified Euler's Method</h1>

  <label>dy/dx = <input type="text" id="function" placeholder="e.g. 3*exp(x) + 2*y"></label>
  <label>x₀: <input type="number" id="x0" value="0" step="any"></label>
  <label>y₀: <input type="number" id="y0" value="0" step="any"></label>
  <label>Target x: <input type="number" id="xTarget" value="0.2" step="any"></label>
  <label>Step size (h): <input type="number" id="step" value="0.1" step="any"></label>

  <button onclick="calculateModifiedEuler()">Calculate</button>
  <button onclick="resetForm()">Reset</button>

  <div id="result"></div>
  <div id="error" class="error"></div>
  <div id="table-container"></div>

  <script>
    async function calculateModifiedEuler() {
      const func = document.getElementById("function").value;
      const x0 = parseFloat(document.getElementById("x0").value);
      const y0 = parseFloat(document.getElementById("y0").value);
      const xTarget = parseFloat(document.getElementById("xTarget").value);
      const h = parseFloat(document.getElementById("step").value);

      const resultDiv = document.getElementById("result");
      const errorDiv = document.getElementById("error");
      const tableDiv = document.getElementById("table-container");
      resultDiv.innerText = "";
      errorDiv.innerText = "";
      tableDiv.innerHTML = "";

      const data = { function: func, x0, y0, x_target: xTarget, h };

      try {
        const res = await fetch("http://127.0.0.1:8000/modified_euler", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await res.json();

        if (result.error) {
          errorDiv.innerText = result.error;
          return;
        }

        resultDiv.innerText = `✅ Final y(${xTarget}) ≈ ${result.result}`;

        let table = `<table>
          <tr>
            <th>Step</th>
            <th>xₙ</th>
            <th>yₙ</th>
            <th>y<sub>predict</sub></th>
            <th>f(xₙ, yₙ)</th>
            <th>f(xₙ₊₁, y<sub>predict</sub>)</th>
            <th>✅ y<sub>final</sub></th>
          </tr>`;

        result.steps.forEach((step) => {
          table += `<tr>
            <td>${step.step}</td>
            <td>${step.x}</td>
            <td>${step.y_n}</td>
            <td>${step.y_predict}</td>
            <td>${step.f1}</td>
            <td>${step.f2}</td>
            <td>${step.y_final}</td>
          </tr>`;
        });

        table += `</table>`;
        tableDiv.innerHTML = table;

      } catch (err) {
        errorDiv.innerText = "❌ Error fetching API";
      }
    }

    function resetForm() {
      document.getElementById("function").value = "";
      document.getElementById("x0").value = "";
      document.getElementById("y0").value = "";
      document.getElementById("xTarget").value = "";
      document.getElementById("step").value = "";
      document.getElementById("result").innerText = "";
      document.getElementById("error").innerText = "";
      document.getElementById("table-container").innerHTML = "";
    }
  </script>
</body>
</html>

